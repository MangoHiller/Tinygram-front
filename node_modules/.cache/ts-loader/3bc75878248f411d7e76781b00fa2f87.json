{"remainingRequest":"/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/thread-loader/dist/cjs.js!/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/babel-loader/lib/index.js!/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/ts-loader/index.js??clonedRuleSet-42.use[3]!/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ruleSet[1].rules[38].use[0]!/home/hugo_leguillier/tinygram-2022-2023/front/src/store/index.ts","dependencies":[{"path":"/home/hugo_leguillier/tinygram-2022-2023/front/src/store/index.ts","mtime":1669130799395},{"path":"/home/hugo_leguillier/tinygram-2022-2023/front/babel.config.js","mtime":1668093862815},{"path":"/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/@vue/cli-plugin-typescript/node_modules/cache-loader/dist/cjs.js","mtime":1668093903975},{"path":"/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/thread-loader/dist/cjs.js","mtime":1668093903990},{"path":"/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/babel-loader/lib/index.js","mtime":1668093897906},{"path":"/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/ts-loader/index.js","mtime":1668093913655},{"path":"/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1668093912746}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY3JlYXRlU3RvcmUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHJvdXRlciBmcm9tICdAL3JvdXRlci9pbmRleCc7CmltcG9ydCBheGlvcyBmcm9tICdAL3BsdWdpbnMvYXhpb3MnOwpleHBvcnQgZGVmYXVsdCBjcmVhdGVTdG9yZSh7CiAgc3RhdGU6IHsKICAgIGNyZWRlbnRpYWxzOiBudWxsLAogICAgdXNlcjogbnVsbAogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBzZXRDcmVkZW50aWFscyhzdGF0ZSwgY3JlZGVudGlhbHMpIHsKICAgICAgc3RhdGUuY3JlZGVudGlhbHMgPSBjcmVkZW50aWFsczsKICAgIH0sCgogICAgcmVtb3ZlQ3JlZGVudGlhbHMoc3RhdGUpIHsKICAgICAgc3RhdGUuY3JlZGVudGlhbHMgPSBudWxsOwogICAgfSwKCiAgICBzZXRVc2VyKHN0YXRlLCB1c2VyKSB7CiAgICAgIHN0YXRlLnVzZXIgPSB1c2VyOwogICAgfSwKCiAgICByZW1vdmVVc2VyKHN0YXRlKSB7CiAgICAgIHN0YXRlLnVzZXIgPSBudWxsOwogICAgfQoKICB9LAogIGFjdGlvbnM6IHsKICAgIGFzeW5jIGxvZ2luKHsKICAgICAgY29tbWl0LAogICAgICBzdGF0ZSwKICAgICAgZGlzcGF0Y2gKICAgIH0sIGNyZWRlbnRpYWxzKSB7CiAgICAgIC8vIEZpcnN0bHkgY2hlY2sgaWYgd2UgaGF2ZSBhY2Nlc3MgdG8gdGhlIEdvb2dsZSBKV1QgVG9rZW4KICAgICAgaWYgKGNyZWRlbnRpYWxzICE9PSBudWxsICYmIGNyZWRlbnRpYWxzICE9PSB2b2lkIDAgJiYgY3JlZGVudGlhbHMuY3JlZGVudGlhbCkgewogICAgICAgIC8vIFNldCB0aGUgZ2xvYmFsIGF4aW9zIEF1dGhvcml6YXRpb24gaGVhZGVyIHRvIG91ciBiZWFyZXIgSldUIHRva2VuCiAgICAgICAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb24gPSB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7Y3JlZGVudGlhbHMuY3JlZGVudGlhbH1gCiAgICAgICAgfTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIC8vIFRoZW4gcmV0cmlldmUgdXNlciBkYXRhIGZyb20gb3VyIEFQSQogICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGF4aW9zLmdldCgnL3VzZXJzL21lJyk7IC8vIENvbW1pdCB0aGUgY3JlZGVudGlhbHMgYW5kIHVzZXIgZGF0YSB0byB0aGUgc3RvcmUKCiAgICAgICAgICBjb21taXQoJ3NldENyZWRlbnRpYWxzJywgY3JlZGVudGlhbHMpOyAvLyBTYXZlIHRoZSB0b2tlbiB0byBrZWVwIHRoZSBzZXNzaW9uIGdvaW5nIHRocm91Z2ggcmVmcmVzaGVzCgogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Rva2VuJywgSlNPTi5zdHJpbmdpZnkoY3JlZGVudGlhbHMuY3JlZGVudGlhbCkpOwogICAgICAgICAgYXdhaXQgZGlzcGF0Y2goJ3JldHJpZXZlVXNlcicpOwogICAgICAgICAgcm91dGVyLnB1c2goJy9ob21lJyk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGRpc3BhdGNoKCdsb2dvdXQnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgYXN5bmMgcmV0cmlldmVVc2VyKHsKICAgICAgY29tbWl0LAogICAgICBzdGF0ZSwKICAgICAgZGlzcGF0Y2gKICAgIH0pIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyBUaGVuIHJldHJpZXZlIHVzZXIgZGF0YSBmcm9tIG91ciBBUEkKICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgYXhpb3MuZ2V0KCcvdXNlcnMvbWUnKTsKICAgICAgICBjb21taXQoJ3NldFVzZXInLCB1c2VyLmRhdGEpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgIGRpc3BhdGNoKCdsb2dvdXQnKTsKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBsb2dvdXQoewogICAgICBjb21taXQsCiAgICAgIHN0YXRlCiAgICB9KSB7CiAgICAgIC8vIFJlbW92ZSB0aGUgdG9rZW4gZnJvbSB0aGUgYXhpb3MgaGVhZGVyCiAgICAgIGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uID0gewogICAgICAgIEF1dGhvcml6YXRpb246ICcnCiAgICAgIH07IC8vIFJlbW92ZSB0aGUgdG9rZW4gZnJvbSB0aGUgc3RvcmUKCiAgICAgIGNvbW1pdCgncmVtb3ZlQ3JlZGVudGlhbHMnKTsKICAgICAgY29tbWl0KCdyZW1vdmVVc2VyJyk7IC8vIFJlbW92ZSB0aGUgdG9rZW4gZnJvbSBsb2NhbCBzdG9yYWdlCgogICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTsgLy8gUmVkaXJlY3QgdG8gdGhlIGxvZ2luIHBhZ2UKCiAgICAgIHJvdXRlci5wdXNoKCcvJyk7CiAgICB9CgogIH0sCiAgZ2V0dGVyczogewogICAgaXNMb2dnZWRJbihzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUudXNlciAhPT0gbnVsbDsKICAgIH0sCgogICAgZ2V0VXNlcihzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUudXNlcjsKICAgIH0KCiAgfSwKICBtb2R1bGVzOiB7fQp9KTs="},{"version":3,"sources":["/home/hugo_leguillier/tinygram-2022-2023/front/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ruleSet[1].rules[38].use[0]!/home/hugo_leguillier/tinygram-2022-2023/front/src/store/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { createStore } from 'vuex';\nimport router from '@/router/index';\nimport axios from '@/plugins/axios';\n\nexport default createStore({\n  state: {\n    credentials: null,\n    user: null,\n  },\n  mutations: {\n    setCredentials(state, credentials) {\n      state.credentials = credentials;\n    },\n    removeCredentials(state) {\n      state.credentials = null;\n    },\n    setUser(state, user) {\n      state.user = user;\n    },\n    removeUser(state) {\n      state.user = null;\n    },\n  },\n  actions: {\n    async login({ commit, state, dispatch }, credentials) {\n      // Firstly check if we have access to the Google JWT Token\n      if (credentials?.credential) {\n        // Set the global axios Authorization header to our bearer JWT token\n        axios.defaults.headers.common = {\n          Authorization: `Bearer ${credentials.credential}`,\n        };\n\n        try {\n          // Then retrieve user data from our API\n          const user = await axios.get('/users/me');\n\n          // Commit the credentials and user data to the store\n          commit('setCredentials', credentials);\n\n          // Save the token to keep the session going through refreshes\n          localStorage.setItem('token', JSON.stringify(credentials.credential));\n\n          await dispatch('retrieveUser');\n          router.push('/home');\n        } catch (error) {\n          dispatch('logout');\n        }\n      }\n    },\n\n    async retrieveUser({ commit, state, dispatch }) {\n      try {\n        // Then retrieve user data from our API\n        const user = await axios.get('/users/me');\n        commit('setUser', user.data);\n      } catch (error) {\n        console.error(error);\n        dispatch('logout');\n      }\n    },\n\n    async logout({ commit, state }) {\n      // Remove the token from the axios header\n      axios.defaults.headers.common = {\n        Authorization: '',\n      };\n\n      // Remove the token from the store\n      commit('removeCredentials');\n      commit('removeUser');\n\n      // Remove the token from local storage\n      localStorage.removeItem('token');\n\n      // Redirect to the login page\n      router.push('/');\n    },\n  },\n  getters: {\n    isLoggedIn(state) {\n      return state.user !== null;\n    },\n    getUser(state) {\n      return (state as any).user;\n    },\n  },\n  modules: {},\n});\n"],"sourceRoot":""}]}